<!-- templates/motos/list.html -->
<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Motos · MotoTracker</title>
    <link rel="stylesheet" th:href="@{/css/app.css}" href="/css/app.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="app app--dark">

<header class="topbar">
    <div class="topbar__left">
        <a class="brand" th:href="@{/}">MotoTracker</a>
    </div>
    <div class="topbar__right" style="display:flex; gap:8px">
        <a class="btn btn--ghost" th:href="@{/mapa}">Mapa</a>
        <a class="btn btn--ghost" th:href="@{/patio}">Pátio</a>
        <a class="btn btn--primary" th:href="@{/motos/new}">Nova moto</a>
    </div>
</header>

<main class="container">
    <div class="page-head">
        <h1 class="page-title">Motos</h1>
    </div>

    <section class="card">
        <div class="table-responsive">
            <table class="table table--list">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Placa</th>
                    <th>Modelo</th>
                    <th>Status</th>
                    <th class="text-right">Ações</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="m : ${motos}">
                    <td th:text="${m.id}">1</td>
                    <td th:text="${m.placa}">ABC1D23</td>
                    <td th:text="${m.modelo}">CG 160</td>
                    <td>
            <span class="badge"
                  th:text="${m.status}"
                  th:classappend="${m.status} == 'ATIVA' ? ' badge--success' :
                                  (${m.status} == 'MANUTENCAO' ? ' badge--warning' : ' badge--muted')">
              ATIVA
            </span>
                    </td>
                    <td class="text-right actions">
                        <a class="btn btn--ghost" th:href="@{/motos/{id}/edit(id=${m.id})}">Editar</a>

                        <th:block th:with="csrfParam=${_csrf != null ? _csrf.parameterName : '_csrf'},
                               csrfToken=${_csrf != null ? _csrf.token : ''}">
                            <form th:action="@{/motos/{id}/delete(id=${m.id})}" method="post" class="inline">
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                                <button type="submit" class="btn btn--danger">Excluir</button>
                            </form>

                            <form th:if="${#strings.equalsIgnoreCase(m.status,'ATIVA')}"
                                  th:action="@{/motos/{id}/patio(id=${m.id})}" method="post" class="inline">
                                <input type="hidden" th:name="${csrfParam}" th:value="${csrfToken}" />
                                <button type="submit" class="btn btn--danger">Enviar p/ Pátio</button>
                            </form>
                        </th:block>
                    </td>
                </tr>

                <tr th:if="${#lists.isEmpty(motos)}">
                    <td colspan="5" class="empty">Nenhuma moto cadastrada.</td>
                </tr>
                </tbody>
            </table>
        </div>
    </section>

    <div class="mt-24">
        <a class="link" th:href="@{/}">Início</a>
        <span> | </span>
        <a class="link" th:href="@{/patio}">Ver Pátio</a>
        <span> | </span>
        <a class="link" th:href="@{/mapa}">Ver Mapa</a>
    </div>
</main>

<footer class="footer">
    <span>© <span th:text="${#dates.format(#dates.createNow(), 'yyyy')}">2025</span> MotoTracker</span>
</footer>

<style>
    .app--dark{background:#0f1315;color:#eaeef0}
    .topbar{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;background:#0b0f10;border-bottom:1px solid #1d262b}
    .brand{font-weight:700;text-decoration:none;color:#eaeef0}
    .container{max-width:1100px;margin:24px auto;padding:0 16px}
    .page-title{margin:0 0 16px}
    .card{background:#0b0f10;border:1px solid #1d262b;border-radius:12px;padding:8px 12px}
    .table{width:100%;border-collapse:collapse}
    .table th,.table td{padding:14px;border-bottom:1px solid #1d262b}
    .table thead th{color:#9fb0b7;font-weight:600;text-transform:uppercase;font-size:12px;letter-spacing:.04em}
    .table tbody tr:hover{background:#0f1518}
    .table .empty{text-align:center;color:#9fb0b7}
    .text-right{text-align:right}
    .inline{display:inline}
    .mt-24{margin-top:24px}
    .link{color:#61e294;text-decoration:none}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:8px;border:1px solid transparent;background:#172025;color:#eaeef0;text-decoration:none;cursor:pointer}
    .btn:hover{background:#1b252a}
    .btn--primary{background:#22c55e;border-color:#22c55e;color:#092414}
    .btn--primary:hover{background:#19ad51;border-color:#19ad51}
    .btn--danger{background:#2b1518;border-color:#7f1d1d;color:#f3c2c2}
    .btn--danger:hover{background:#3a1c20}
    .btn--ghost{background:transparent;border-color:#2a383f}
    .btn--ghost:hover{background:#12191c}
    .badge{display:inline-block;padding:.25rem .5rem;border-radius:999px;font-size:.75rem;border:1px solid #26343a}
    .badge--success{background:#0e3020;border-color:#1d5c3a;color:#5de39e}
    .badge--warning{background:#2b2614;border-color:#5c4a1d;color:#e6d58a}
    .badge--muted{background:#1a2226;border-color:#2a383f;color:#a9bbc2}
    .footer{padding:24px;color:#8aa1aa;text-align:center}
</style>

</body>
</html>
