<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Pátio de Motos</title>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <style>
        body{background:#0f1315;color:#eaeef0;margin:0}
        .topbar{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;background:#0b0f10;border-bottom:1px solid #1d262b}
        .brand{font-weight:700;text-decoration:none;color:#eaeef0}
        .container{max-width:1100px;margin:24px auto;padding:0 16px}
        .filters{display:flex;gap:8px;margin:12px 0 20px}
        .btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:8px;border:1px solid #2a383f;background:transparent;color:#eaeef0;text-decoration:none;cursor:pointer}
        .btn:hover{background:#12191c}
        .btn--primary{background:#22c55e;border-color:#22c55e;color:#092414}
        .btn--primary:hover{background:#19ad51;border-color:#19ad51}
        .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px}
        .card{background:#0b0f10;border:1px solid #1d262b;border-radius:12px;padding:12px}
        .row{display:flex;justify-content:space-between;align-items:center;margin:6px 0}
        .badge{display:inline-block;padding:.25rem .5rem;border-radius:999px;font-size:.75rem;border:1px solid #26343a}
        .badge--success{background:#0e3020;border-color:#1d5c3a;color:#5de39e}
        .badge--warning{background:#2b2614;border-color:#5c4a1d;color:#e6d58a}
        .badge--muted{background:#1a2226;border-color:#2a383f;color:#a9bbc2}
    </style>
</head>
<body>
<header class="topbar">
    <a class="brand" th:href="@{/}">MotoTracker</a>
    <div style="display:flex;gap:8px">
        <a class="btn" th:href="@{/motos}">Motos</a>
        <a class="btn" th:href="@{/mapa}">Mapa</a>
    </div>
</header>

<main class="container">
    <h1>Pátio de Motos</h1>

    <div class="filters">
        <button class="btn" data-filter="ALL">Todos</button>
        <button class="btn" data-filter="MANUTENCAO">Manutenção</button>
        <button class="btn" data-filter="DESATIVADA">Desativadas</button>
    </div>

    <div class="grid" id="grid">
        <div class="card" th:each="m : ${motos}" th:attr="data-status=${m.status}">
            <div class="row">
                <strong th:text="${m.placa}">ABC1D23</strong>
                <span class="badge"
                      th:text="${m.status}"
                      th:classappend="${m.status} == 'MANUTENCAO' ? ' badge--warning' : ' badge--muted'">DESATIVADA</span>
            </div>
            <div class="row">
                <span th:text="${m.modelo}">CG 160</span>
                <a class="btn" th:href="@{/motos/{id}/edit(id=${m.id})}">Editar</a>
            </div>

            <th:block th:with="csrfParam=${_csrf != null ? _csrf.parameterName : '_csrf'},
                         csrfToken=${_csrf != null ? _csrf.token : ''}">
                <form th:action="@{/motos/{id}/ativar(id=${m.id})}" method="post" style="margin-top:8px">
                    <input type="hidden" th:name="${csrfParam}" th:value="${csrfToken}" />
                    <button type="submit" class="btn btn--primary">Ativar</button>
                </form>
            </th:block>
        </div>

        <div th:if="${#lists.isEmpty(motos)}" style="grid-column:1/-1;color:#9fb0b7">
            Nenhuma moto no pátio.
        </div>
    </div>
</main>

<script>
    const grid = document.getElementById('grid');
    document.querySelectorAll('[data-filter]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
            const f = btn.getAttribute('data-filter');
            grid.querySelectorAll('[data-status]').forEach(card=>{
                const st = (card.getAttribute('data-status')||'').toUpperCase();
                card.style.display = (f==='ALL' || st===f) ? '' : 'none';
            });
        });
    });
</script>
</body>
</html>
